!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery"),window,document):e(jQuery,window,document)}(function(e,t,i,n){"use strict";e.fn.on||(e.fn.on=function(e,t,i,n){return this.delegate(t,e,i,n)}),e.extend({DirtyForms:{message:"You've made changes on this page which aren't saved. If you leave you will lose these changes.",title:"Are you sure you want to do that?",dirtyClass:"dirty",listeningClass:"dirtylisten",ignoreClass:"ignoredirty",choiceContinue:!1,helpers:[],dialog:{selector:"#facebox .content",fire:function(t,i){var n="<h1>"+i+"</h1><p>"+t+'</p><p><a href="#" class="ignoredirty button medium red continue">Continue</a><a href="#" class="ignoredirty button medium cancel">Stop</a></p>';e.facebox(n)},bind:function(){var t=function(t){return function(n){("keydown"!==n.type||"keydown"===n.type&&27===n.which)&&(o.dialogStash||e(i).trigger("close.facebox"),t(n))}};e(i).bind("keydown.facebox",t(o.decidingCancel)),e("#facebox .cancel, #facebox .close, #facebox_overlay").click(t(o.decidingCancel)),e("#facebox .continue").click(t(o.decidingContinue))},stash:function(){var t=e("#facebox");return""===e.trim(t.html())||"block"!=t.css("display")?!1:e("#facebox .content").clone(!0)},refire:function(t,i){e.facebox(t)}},isDirty:function(){return e(":dirtylistening").dirtyForms("isDirty")},disable:function(){e("html").addClass(o.ignoreClass)},ignoreParentDocs:function(){o.watchParentDocs=!1},choiceCommit:function(t){o.deciding&&(e(i).trigger("choicecommit.dirtyforms"),o.choiceContinue?o.decidingContinue(t):o.decidingCancel(t),e(i).trigger("choicecommitAfter.dirtyforms"))},isDeciding:function(){return o.deciding},decidingContinue:function(t){v(),t.preventDefault(),o.dialogStash=!1,e(i).trigger("decidingcontinued.dirtyforms"),C(o.decidingEvent),o.deciding=o.currentForm=o.decidingEvent=!1},decidingCancel:function(t){t.preventDefault(),e(i).trigger("decidingcancelled.dirtyforms"),o.dialog!==!1&&o.dialogStash!==!1&&"function"==typeof o.dialog.refire&&o.dialog.refire(o.dialogStash.html(),t),e(i).trigger("decidingcancelledAfter.dirtyforms"),o.deciding=o.currentForm=o.decidingEvent=o.dialogStash=!1}}}),e.extend(e.expr[":"],{dirtylistening:function(t){return e(t).hasClass(o.listeningClass)},dirty:function(t){return e(t).hasClass(o.dirtyClass)}});var r={init:function(){u();var t="textarea,input:not([type='checkbox'],[type='radio'],[type='button'],[type='image'],[type='submit'],[type='reset'],[type='file'],[type='search'])",n=e(i.activeElement);return n.is(t)&&(o.focused.element=n,o.focused.value=n.val()),this.each(function(i){var n=e(this);n.is("form")&&n.addClass(o.listeningClass).on("focus change",t,c).on("change","input[type='checkbox'],input[type='radio'],select",a).on("click","input[type='reset']",s)})},isDirty:function(){var t=!1,i=this;return d()?(t=!0,!0):(this.each(function(i){return e(this).hasClass(o.dirtyClass)?(t=!0,!1):void 0}),t?!0:(e.each(o.helpers,function(e,n){return"isDirty"in n&&n.isDirty(i)?(t=!0,!1):"isNodeDirty"in n&&n.isNodeDirty(i)?(t=!0,!1):void 0}),t))},setDirty:function(){return this.each(function(t){e(this).addClass(o.dirtyClass).parents("form").addClass(o.dirtyClass)})},setClean:function(){return o.focused={element:!1,value:!1},this.each(function(t){var i=this,n=e(this);if(n.removeClass(o.dirtyClass),n.is("form"))n.find(":dirty").removeClass(o.dirtyClass);else{var r=n.parents("form");0===r.find(":dirty").length&&r.removeClass(o.dirtyClass)}e.each(o.helpers,function(e,t){"setClean"in t&&t.setClean(i)})})}};e.fn.dirtyForms=function(t){return r[t]?r[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.dirtyForms"):r.init.apply(this,arguments)},e.fn.setDirty=function(){return this.dirtyForms("setDirty")},e.fn.isDirty=function(){return this.dirtyForms("isDirty")},e.fn.cleanDirty=function(){return this.dirtyForms("setClean")};var o=e.DirtyForms=e.extend({watchParentDocs:!0,exitBound:!1,formStash:!1,dialogStash:!1,deciding:!1,decidingEvent:!1,currentForm:!1,focused:{element:!1,value:!1}},e.DirtyForms),s=function(){e(this).parents("form").dirtyForms("setClean"),o.onFormCheck&&o.onFormCheck()},a=function(){p(e(this))||(e(this).dirtyForms("setDirty"),o.onFormCheck&&o.onFormCheck())},c=function(){var t=e(this);d()&&!p(t)&&(o.focused.element.dirtyForms("setDirty"),o.onFormCheck&&o.onFormCheck()),o.focused.element=t,o.focused.value=t.val()},d=function(){return o.focused.element&&o.focused.element.val()!==o.focused.value},u=function(){if(!o.exitBound){var n=top!==self;e(i).on("click","a[href]",f).on("submit","form",g),e(t).bind("beforeunload",h),o.watchParentDocs&&n&&(e(top.document).on("click","a[href]",f).on("submit","form",g),e(top.window).bind("beforeunload",h)),o.exitBound=!0}},l=function(){var t="";return e.each(o.helpers,function(e,i){"ignoreAnchorSelector"in i&&(t.length>0&&(t+=","),t+=i.ignoreAnchorSelector)}),t},f=function(t){e(this).is(l())||m(e(this))||y(t)},g=function(e){o.currentForm=this,y(e)},h=function(e){var i=y(e);return i&&o.doubleunloadfix!==!0&&(o.deciding=!1),o.doubleunloadfix=!0,setTimeout(function(){o.doubleunloadfix=!1},200),"string"==typeof i?(e=e||t.event,e&&(e.returnValue=i),i):void 0},y=function(t){var n=e(t.target),r=t.type;return t.isDefaultPrevented()?!1:"beforeunload"==r&&o.doubleunloadfix?(o.doubleunloadfix=!1,!1):p(n)?(v(),!1):o.deciding?!1:o.isDirty()?"submit"==r&&n.dirtyForms("isDirty")?(v(),!0):(e(i).trigger("defer.dirtyforms"),"beforeunload"==r?o.message:void(o.dialog&&(o.deciding=!0,o.decidingEvent=t,"function"==typeof o.dialog.stash&&(o.dialogStash=o.dialog.stash()),t.preventDefault(),t.stopImmediatePropagation(),o.formStash="string"==typeof o.dialog.selector&&n.is("form")&&n.parents(o.dialog.selector).length>0?n.clone(!0).hide():!1,o.dialog.fire(o.message,o.title),"function"==typeof o.dialog.bind&&o.dialog.bind()))):(v(),!1)},m=function(e){var t=e.attr("target");return"string"==typeof t?"_blank"===t.toLowerCase():!1},p=function(e){return e.closest("."+o.ignoreClass).length>0},v=function(){e(t).unbind("beforeunload",h),t.onbeforeunload=null,e(i).trigger("beforeunload.dirtyforms")},C=function(t){if(e(i).trigger("beforeRefire.dirtyforms"),"click"===t.type){var n=new e.Event("click");if(e(t.target).trigger(n),!n.isDefaultPrevented()){var r=e(t.target).closest("[href]").attr("href");return void(location.href=r)}}else{var s;o.formStash?(s=o.formStash,e("body").append(s)):s=e(t.target).closest("form"),s.trigger(t.type)}}});
//# sourceMappingURL=jquery.dirtyforms.min.js.map